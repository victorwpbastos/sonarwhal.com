!function(){"use strict";var e=document.createElement("button");if(e.setAttribute("type","menu"),!("menu"===e.type))var t={down:40,enter:13,escape:27,space:32,tab:9,up:38},n=function(e){return[].slice.call(e)},r=function(e,t){var r=n(e.attributes),i=e.getAttribute("type");r.forEach(function(e){var n="radio"===i&&"radiogroup"===e.name?"name":e.name;t.setAttribute(n,e.nodeValue?e.nodeValue:"")})},i=function(e){var t=e.getAttribute("menu");e.setAttribute("aria-haspopup","true"),e.setAttribute("aria-owns",t)},u=function(e){var t=e.getAttribute("menu"),n=document.createElement("div");return n.className="wrap-menu-button",n.innerHTML='<ul role="menu" hidden id="'+t+'"></ul>',n},o=function(e){var t=document.createElement("li"),n=document.createElement("input"),i=document.createElement("label"),u=e.getAttribute("id"),o=e.getAttribute("label");return r(e,n),n.setAttribute("role","menuitem"+n.getAttribute("type")),n.setAttribute("aria-label",n.getAttribute("label")),t.setAttribute("role","presentation"),i.setAttribute("for",u),i.setAttribute("aria-hidden","true"),i.textContent=o,t.appendChild(n),t.appendChild(i),t},a=function(e){i(e);var t=e.getAttribute("menu"),r=document.getElementById(t),a=n(r.children),d=u(e),c=d.querySelector("ul");a.forEach(function(e){var t=o(e);c.appendChild(t)}),e.parentNode.insertBefore(d,e),c.parentNode.insertBefore(e,c),d.appendChild(c),r.parentNode.removeChild(r)},d=function(e,t){for(var n=0,r=!1,i=0;i<e.length;i++)if(e[i]===t){r=!0,n=i;break}return r?n:-1},c=function(){v.forEach(function(e){e.collapse()})},l=function(e,t){var n=t||document.activeElement,r=d(e,n);if(-1===r)return void console.log("something weird is going on");++r>=e.length&&(r=0);var i=e[r];i.disabled?l(e,i):e[r].focus()},m=function(e,t){var n=t||document.activeElement,r=d(e,n);if(-1!==r){--r<0&&(r=e.length-1);var i=e[r];i.disabled?m(e,i):i.focus()}},f=function(e){return function(t){for(var n=!0,r=0;r<e.length;r++)if(e[r]===t.target||e[r]===t.target.control){n=!1,e[r].focus();break}n&&(c(),document.activeElement.blur())}},s=function(e){var t=document.getElementById(e.getAttribute("menu")),n=t.innerHTML;(n.match(/<\/menuitem>/gi)||[]).length>1&&1===t.children.length&&(n=n.replace(/<\/menuitem>/gi,"").replace(/>/g,"></menuitem>")),t.innerHTML=n},b=function(e){s(e),a(e);var r=e.getAttribute("aria-owns"),i=document.getElementById(r),u=n(i.querySelectorAll("input")),o=u[0],d=f(u.concat([e])),c=function(){return""!==e.getAttribute("disabled")},b=function(){return"true"===e.getAttribute("aria-expanded")},p=function(){o.focus()},v=function(){i.removeAttribute("hidden"),e.setAttribute("aria-expanded","true"),window.addEventListener("keydown",A,!0),window.addEventListener("click",d,!0),p()},g=function(){i.setAttribute("hidden",""),e.setAttribute("aria-expanded","false"),window.removeEventListener("keydown",A,!1),window.removeEventListener("click",d,!0)},h=function(){b()?g():v()},A=function(n){var r=n.keyCode;return!b()||r!==t.tab&&r!==t.escape?b()?void(r===t.up?(n.preventDefault(),m(u)):r===t.down&&(n.preventDefault(),l(u))):void 0:(e.focus(),void g())},E=function(e){var n=e.keyCode;if(!b()&&(n===t.enter||n===t.space||n===t.up||n===t.down))return void v()};return e.addEventListener("click",h,!0),e.addEventListener("keyup",E,!0),{collapse:g,expand:v,isEnabled:c,isExpanded:b}},p=n(document.querySelectorAll("button[menu]")),v=p.map(function(e){return b(e)})}(),function(){"use strict";var e=document.createElement("input");e.id="a",document.body.appendChild(e);var t=document.createElement("label");t.setAttribute("for","a"),document.body.appendChild(t);var n=t.control===e;if(document.body.removeChild(t),document.body.removeChild(e),!n){[].slice.call(document.querySelectorAll("label")).forEach(function(e){var t=e.htmlFor;t&&(e.control=document.getElementById(t))})}}();