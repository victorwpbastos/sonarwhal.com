<!doctype html><html lang="en"><head><meta charset="utf-8"><title>Validate &#x60;Set-Cookie&#x60; Header | sonar documentation</title><meta property="og:image" content="/images/apple-touch-icon.png"><meta property="og:description" content="This rule validates the set-cookie header and confirms that theSecure and HttpOnly directives are defined when sent from asecure origin (HTTPS)."><meta property="og:title" content="Validate &#x60;Set-Cookie&#x60; Header"><meta name="description" content="This rule validates the set-cookie header and confirms that theSecure and HttpOnly directives are defined when sent from asecure origin (HTTPS)."><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#4046dd"><link rel="manifest" href="/site.webmanifest"><link rel="apple-touch-icon" href="/images/apple-touch-icon.png"><link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32"><link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16"><link rel="stylesheet" href="/core/css/about.css"><link rel="stylesheet" href="/core/css/base.css"><link rel="stylesheet" href="/core/css/color.css"><link rel="stylesheet" href="/core/css/footer.css"><link rel="stylesheet" href="/core/css/helpers.css"><link rel="stylesheet" href="/core/css/layouts.css"><link rel="stylesheet" href="/core/css/media.css"><link rel="stylesheet" href="/core/css/navigation.css"><link rel="stylesheet" href="/core/css/search-results.css"><link rel="stylesheet" href="/core/css/structure.css"><link rel="stylesheet" href="/core/css/type.css"><link rel="stylesheet" href="/core/css/highlight.css"><link rel="stylesheet" href="/components/breadcrumb/breadcrumb.css"><link rel="stylesheet" href="/components/pagination/pagination.css"><link rel="stylesheet" href="/core/css/controls.css"><link rel="stylesheet" href="/core/css/scanner.css"><link href="https://fonts.googleapis.com/css?family=Montserrat:200,300,400,500" rel="stylesheet"><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css"><link rel="stylesheet" href="/core/css/code.css"><link rel="stylesheet" href="/core/css/table-of-contents.css"><link rel="stylesheet" href="/core/css/tables-lists.css"><link rel="stylesheet" href="/components/treeview/treeview.css"><link rel="stylesheet" href="/core/css/documentation.css"></head><body><header class="header"><div class="nav-bar container"><nav class="nav"><a href="/" class="clear logo--container"><img src="/images/sonar-logo.svg" alt="sonar" class="header__logo navbar__navitem"></a><ul class="nav__navbar"><li class="navbar__navitem"><a role="button" href="/scanner/" id="scanner" aria-haspopup="true" aria-expanded="false" aria-controls="submenu-scanner" class="navitem__button">Scanner</a></li><li class="navbar__navitem"><a role="button" href="/docs/" id="docs" aria-haspopup="true" aria-expanded="false" aria-controls="submenu-docs" class="navitem__button expandable">Documentation</a><ul role="group" id="submenu-docs" class="navbar__submenu" aria-hidden="true"><li><a href="/docs/contributor-guide/">Contributor Guide</a></li><li><a href="/docs/user-guide/rules/">Rules</a></li><li><a href="/docs/user-guide/">User Guide</a></li></ul></li><li class="navbar__navitem"><a role="button" href="/about/" id="about" aria-haspopup="true" aria-expanded="false" aria-controls="submenu-about" class="navitem__button expandable">About</a><ul role="group" id="submenu-about" class="navbar__submenu" aria-hidden="true"><li><a href="/about/faq/">FAQ</a></li><li><a href="/about/changelog/">Changelog</a></li><li><a href="/about/governance/">Governance</a></li><li><a href="/about/contributors/">Contributors</a></li><li><a href="https://js.foundation/community/code-of-conduct">Code of Conduct</a></li></ul></li></ul><div class="nav-bar__input"><form action="/search" method="GET"><label for="search-input" class="visually-hidden">Search the documentation</label><input type="search" id="search-input" placeholder="Search…" name="q" aria-label="Search"></form></div></nav><button class="header__toggle mobile-nav-button" aria-label="Menu"></button></div></header><main class="container"><article class="content" aria-labelledby="page-heading"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/">Home</a></li><li><a href="../../">Documentation</a></li><li><a href="../../" class="guide-category">User guide</a></li><li aria-current="location">Validate &#x60;Set-Cookie&#x60; Header</li></ul></nav><header class="page-intro"><h1 id="page-heading">Validate &#x60;Set-Cookie&#x60; Header</h1><div class="documentation-actions"><ul><li><a target="_blank" href="https://github.com/sonarwhal/sonar/blob/master/docs/user-guide/rules/validate-set-cookie-header/index.md">Edit</a></li><li><a target="_blank" href="https://github.com/sonarwhal/sonar/issues/new?title&#x3D;%5Bdocs%5D%20Issue%20with%20&#x27;Validate%20%60Set-Cookie%60%20Header&#x27;&amp;body&#x3D;https%3A%2F%2Fsonarwhal.com%2Fdocs%2Fuser-guide%2Frules%2Fvalidate-set-cookie-header%2Findex.html">Signal Issue</a></li></ul></div></header><div class="section"><div class="layout layout--sidebar"><div class="module module--primary wrap-text"><h1 id="validateset-cookieheadervalidate-set-cookie-header">Validate <code>Set-Cookie</code> Header (<code>validate-set-cookie-header</code>)<a href="#validateset-cookieheadervalidate-set-cookie-header" class="headerlink" title="Validate Set-Cookie Header (validate-set-cookie-header)"></a></h1><p>This rule validates the <code>set-cookie</code> header and confirms that the <code>Secure</code> and <code>HttpOnly</code> directives are defined when sent from a secure origin (HTTPS).</p><h2 id="whyisthisimportant">Why is this important?<a href="#whyisthisimportant" class="headerlink" title="Why is this important?"></a></h2><p>A cookie is a small piece of information sent from a server to a user agent. The user agent might save it and send it along with future requests to identify the user session, track and analyze user behavior or inform the server of the user preferences. As a result, it contains sensitive data in a lot of the cases. To create a cookie, the <code>Set-Cookie</code> header is sent from a server in reponse to requests.</p><p>In the <code>Set-Cookie</code> header, a cookie is defined by a name associated with a value. And a web server is allowed to configure the <code>domain</code> and <code>path</code> directives to restrain the scope of cookies. While session cookies are deleted when a browser shuts down, the permanent cookies expire at the time defined by <code>Expires</code> or <code>Max-Age</code>.</p><p>Among the directives, the <code>Secure</code> and <code>HttpOnly</code> attributes are particularly relevant to the security of cookies:</p><ul><li>Setting <code>Secure</code> directive forbids a cookie to be transmitted via simple HTTP.</li><li>Setting the <code>HttpOnly</code> directive prevents access to cookie value through javascript.</li></ul><p>Applying both of these directives makes it difficult to exploit cross-site scripting (<a href="https://developer.mozilla.org/en-US/docs/Glossary/Cross-site_scripting" target="_blank" rel="noopener noreferrer external">XSS</a>) vulnerability and hijack the authenticated user sessions. The <a href="https://en.wikipedia.org/wiki/HTTP_cookie" target="_blank" rel="noopener noreferrer external">wiki</a> page of <code>HTTP cookies</code> offers detailed examples of <a href="https://en.wikipedia.org/wiki/HTTP_cookie#Cross-site_scripting:_cookie_theft" target="_blank" rel="noopener noreferrer external">cookie theft</a> and <a href="https://en.wikipedia.org/wiki/HTTP_cookie#Cross-site_scripting:_proxy_request" target="_blank" rel="noopener noreferrer external">proxy request</a> when cookies are not well protected. According to the RFC <a href="https://tools.ietf.org/html/rfc6265" target="_blank" rel="noopener noreferrer external">HTTP State Management Mechanism</a>, “When using cookies over a secure channel, servers SHOULD set the Secure attribute for every cookie”. As a result, this rule checks if <code>Secure</code> and <code>HttpOnly</code> directives are properly used, and also offers to validate the <code>Set-Cookie</code> header syntax.</p><p>Note: More information about <code>Set-cookie</code> header is available in the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie" target="_blank" rel="noopener noreferrer external">MDN web docs</a>.</p><h2 id="whatdoestherulecheck">What does the rule check?<a href="#whatdoestherulecheck" class="headerlink" title="What does the rule check?"></a></h2><ul><li><p><code>Secure</code> and <code>HttpOnly</code> cookies:</p><ul><li><code>Secure</code> and <code>HttpOnly</code> directives <strong>should</strong> be present if sites are secure.</li><li><code>Secure</code> directive <strong>should not</strong> be present if sites are insecure.</li></ul></li><li><p>Cookie prefixes:</p><ul><li><code>__Secure-</code> and <code>__Host-</code> prefixes <strong>can</strong> be used only if sites are secure.</li><li><p>Cookies with the <code>__Host-</code> prefix <strong>should</strong> have a <code>path</code> of “/“ (the entire host) and <strong>should not</strong> have a <code>domain</code> attribute.</p><p>Read more: <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#Cookie_prefixes" target="_blank" rel="noopener noreferrer external">cookie prefixes</a>.</p></li></ul></li><li><p>Syntax validation:</p><ul><li>Validate cookie name and value string.</li><li>Validate <code>Expires</code> value date format.</li></ul></li><li><p>Browser compatibility of <code>Max-Age</code> directive:</p><ul><li>Some browsers (ie6, ie7, and ie8) doesn’t support <code>Max-Age</code>.</li></ul></li></ul><h3 id="examplesthattriggertherule">Examples that <strong>trigger</strong> the rule<a href="#examplesthattriggertherule" class="headerlink" title="Examples that trigger the rule"></a></h3><p><code>Set-Cookie</code> header that doesn’t have a name-value string:</p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">HTTP/... 200 OK</div><div class="line"></div><div class="line">...</div><div class="line">Set-Cookie: Max-Age=0; Secure; HttpOnly</div></pre></td></tr></table></figure><p><code>Set-Cookie</code> header that doesn’t have the <code>Secure</code> directive:</p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">HTTP/... 200 OK</div><div class="line"></div><div class="line">...</div><div class="line">Set-Cookie: cookieName=cookieValue; HttpOnly</div></pre></td></tr></table></figure><p><code>Set-Cookie</code> header that doesn’t have the <code>HttpOnly</code> directive:</p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">HTTP/... 200 OK</div><div class="line"></div><div class="line">...</div><div class="line">Set-Cookie: cookieName=cookieValue; Secure</div></pre></td></tr></table></figure><p><code>Set-Cookie</code> header that has invalid <code>name</code> or <code>value</code> string:</p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">HTTP/... 200 OK</div><div class="line"></div><div class="line">...</div><div class="line">Set-Cookie: &quot;cookieName&quot;=cookieValue; Secure; HttpOnly</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">HTTP/... 200 OK</div><div class="line"></div><div class="line">...</div><div class="line">Set-Cookie: cookieName=cookie value; Secure; HttpOnly</div></pre></td></tr></table></figure><p><code>Set-Cookie</code> header that has prefixes in the cookie name but is sent from pages using <code>http</code> protocol:</p><p>From an insecure origin (HTTP):</p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">HTTP/... 200 OK</div><div class="line"></div><div class="line">...</div><div class="line">Set-Cookie: __Secure-ID=123; Secure; Domain=example.com</div></pre></td></tr></table></figure><p><code>Set-Cookie</code> header that has <code>__Host-</code> prefix in the cookie name but has <code>Path</code> absent or <code>Domain</code> defined:</p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">HTTP/... 200 OK</div><div class="line"></div><div class="line">...</div><div class="line">Set-Cookie: __Host-id=1; Secure</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">HTTP/... 200 OK</div><div class="line"></div><div class="line">...</div><div class="line">Set-Cookie: __Host-id=1; Secure; Path=/; domain=example.com</div></pre></td></tr></table></figure><h3 id="examplesthatpasstherule">Examples that <strong>pass</strong> the rule<a href="#examplesthatpasstherule" class="headerlink" title="Examples that pass the rule"></a></h3><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">HTTP/... 200 OK</div><div class="line"></div><div class="line">...</div><div class="line">Set-Cookie: cookieName=cookieValue; Secure; HttpOnly</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">HTTP/... 200 OK</div><div class="line"></div><div class="line">...</div><div class="line">Set-Cookie: cookieName=&quot;cookieValue&quot;; Secure; HttpOnly</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">HTTP/... 200 OK</div><div class="line"></div><div class="line">...</div><div class="line">Set-Cookie: __Host-ID=123; Secure; Path=/; HttpOnly</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">HTTP/... 200 OK</div><div class="line"></div><div class="line">...</div><div class="line">Set-Cookie: __Secure-ID=123; Secure; Domain=example.com; HttpOnly</div></pre></td></tr></table></figure></div><div class="module module--secondary table-of-contents treeview" role="navigation"><ul role="tree" aria-labelledby="page-heading" tabindex="0"><li role="treeitem" aria-label="subsection" tabindex="0" aria-expanded="false"><div class="toc-section-title"><span class="text">connectors</span> <span class="icon"></span></div><ul role="group"><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/connectors/" tabindex="-1">Connectors</a></div></li></ul></li><li role="treeitem" aria-label="subsection" tabindex="0" aria-expanded="false"><div class="toc-section-title"><span class="text">formatters</span> <span class="icon"></span></div><ul role="group"><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/formatters/" tabindex="-1">List of official formatters</a></div></li></ul></li><li role="treeitem" aria-label="subsection" tabindex="0" aria-expanded="true"><div class="toc-section-title--active"><span class="text">rules</span> <span class="icon"></span></div><ul role="group"><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/rules/">Rules categories</a></div></li><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/rules/amp-validator/">AMP HTML Validator</a></div></li><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/rules/axe/">Accessibility assessment with aXe</a></div></li><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/rules/no-disallowed-headers/">Disallow certain HTTP headers</a></div></li><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/rules/manifest-file-extension/">Disallow non-standard file extension for the web app manifest file</a></div></li><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/rules/no-protocol-relative-urls/">Disallow protocol-relative URLs</a></div></li><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/rules/no-friendly-error-pages/">Disallow small error pages</a></div></li><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/rules/no-html-only-headers/">Disallow unneeded HTTP headers for non-HTML resources</a></div></li><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/rules/image-optimization-cloudinary/">Image optimization with Cloudinary</a></div></li><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/rules/no-vulnerable-javascript-libraries/">No vulnerable libraries</a></div></li><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/rules/html-checker/">Nu HTML Test</a></div></li><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/rules/content-type/">Require &#x60;Content-Type&#x60; HTTP response header with appropriate value</a></div></li><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/rules/strict-transport-security/">Require &#x60;Strict-Transport-Security&#x60; response header</a></div></li><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/rules/x-content-type-options/">Require &#x60;X-Content-Type-Options&#x60; HTTP response header</a></div></li><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/rules/manifest-exists/">Require a web app manifest file</a></div></li><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/rules/apple-touch-icons/">Require an apple touch icon</a></div></li><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/rules/meta-charset-utf-8/">Require charset meta tag with the value of &#x60;utf-8&#x60;</a></div></li><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/rules/disown-opener/">Require external links to disown opener</a></div></li><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/rules/highest-available-document-mode/">Require highest available document mode</a></div></li><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/rules/manifest-app-name/">Require manifest to specify the web site/app name</a></div></li><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/rules/meta-viewport/">Require viewport meta tag with proper value</a></div></li><li role="treeitem"><div class="toc-subsection-title"><a class="text" href="/docs/user-guide/rules/ssllabs/">SSL Server Test</a></div></li><li role="treeitem" aria-selected="true"><div class="toc-subsection-title--active" aria-current="location"><a class="text" href="/docs/user-guide/rules/validate-set-cookie-header/">Validate &#x60;Set-Cookie&#x60; Header</a></div></li></ul></li></ul></div></div></div></article></main><footer class="footer footer--home"><div class="footer-nav container"><div class="footer-nav__item"><p class="category"><a href="/scanner/">Scanner</a></p><ul></ul></div><div class="footer-nav__item"><p class="category"><a href="/docs/">Documentation</a></p><ul><li><a href="/docs/contributor-guide/">Contributor Guide</a></li><li><a href="/docs/user-guide/rules/">Rules</a></li><li><a href="/docs/user-guide/">User Guide</a></li></ul></div><div class="footer-nav__item"><p class="category"><a href="/about/">About</a></p><ul><li><a href="/about/faq/">FAQ</a></li><li><a href="/about/changelog/">Changelog</a></li><li><a href="/about/governance/">Governance</a></li><li><a href="/about/contributors/">Contributors</a></li><li><a href="https://js.foundation/community/code-of-conduct">Code of Conduct</a></li></ul></div><ul class="footer-nav__item social-list"><li class="github-icon"><a href="https://github.com/sonarwhal" aria-label="Follow Sonar on GitHub"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25"><path class="github-icon-svg" d="M12.5.4C5.7.4.2 5.9.2 12.7c0 5.4 3.5 10 8.4 11.7.6.1.8-.3.8-.6v-2.1C6 22.4 5.3 20 5.3 20c-.6-1.4-1.4-1.8-1.4-1.8-1.1-.7.1-.7.1-.7 1.2.1 1.9 1.3 1.9 1.3 1.1 1.9 2.9 1.3 3.6 1 .1-.8.4-1.3.8-1.6-2.7-.3-5.6-1.4-5.6-6.1 0-1.3.5-2.4 1.3-3.3-.2-.4-.6-1.6 0-3.3 0 0 1-.3 3.4 1.3 1-.3 2-.4 3.1-.4 1 0 2.1.1 3.1.4C17.9 5.2 19 5.5 19 5.5c.7 1.7.2 2.9.1 3.3.8.9 1.3 2 1.3 3.3 0 4.7-2.9 5.8-5.6 6.1.4.4.8 1.1.8 2.3v3.4c0 .3.2.7.8.6 4.9-1.6 8.4-6.2 8.4-11.7C24.8 5.9 19.3.4 12.5.4"/></svg></a></li><li class="twitter-icon"><a href="https://twitter.com/narwhalnellie" aria-label="Follow Sonar on Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 24"><path class="twitter-icon-svg" d="M25 4.4c-.9.4-1.9.7-2.9.8 1-.6 1.8-1.6 2.2-2.8-1 .6-2.1 1-3.2 1.2-.9-1-2.2-1.6-3.7-1.6-2.8 0-5 2.3-5 5 0 .4 0 .8.1 1.2C8.3 8 4.6 6 2.1 2.9c-.4.8-.7 1.6-.7 2.6 0 1.8.9 3.3 2.2 4.2-.8-.1-1.5-.3-2.2-.7v.1c0 2.4 1.7 4.5 4.1 5-.4.1-.9.2-1.3.2-.3 0-.6 0-.9-.1.6 2 2.5 3.5 4.7 3.5-1.9 1.3-4 2.1-6.4 2.1-.4 0-.8 0-1.2-.1C2.6 21.2 5.3 22 8.1 22c9.3 0 14.4-7.7 14.4-14.4v-.7c1-.6 1.8-1.5 2.5-2.5"/></svg></a></li></ul></div></footer><script async src="/components/treeview/treeview.js"></script><script async src="/js/nav.js"></script><script async src="/core/scripts/form-validation.js"></script><script async src="/components/accordion/accordion.js"></script><script src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script>!function(){var e,o=docsearch({apiKey:"2ee58f908e6d720c4f72a9645ce0e857",indexName:"sonarwhal",inputSelector:"#search-input",appId:"0R8E5SPAFP",debug:!1,handleSelected:function(o,t,n){window.innerWidth<e?t.target.closest("form").submit():window.location.href=n.url}}),t=document.querySelector(".algolia-autocomplete .ds-dropdown-menu");e=parseInt(window.getComputedStyle(t).minWidth),o.autocomplete.on("autocomplete:opened",function(){document.body.clientWidth<e&&o.autocomplete.autocomplete.close()})}()</script><script>!function(e,t,a,c,n){e.GoogleAnalyticsObject=a,e[a]||(e[a]=function(){(e[a].q=e[a].q||[]).push(arguments)}),e[a].l=+new Date,c=t.createElement("script"),n=t.scripts[0],c.src="https://www.google-analytics.com/analytics.js",n.parentNode.insertBefore(c,n)}(this,document,"ga"),ga("create","UA-101540923-1"),ga("send","pageview")</script></body></html>